(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{544:function(s,t,a){s.exports=a.p+"assets/img/compute.ee9640de.png"},545:function(s,t,a){s.exports=a.p+"assets/img/storage.294c1e8e.png"},546:function(s,t,a){s.exports=a.p+"assets/img/network.b3eccf60.png"},547:function(s,t,a){s.exports=a.p+"assets/img/instance.9aff26ec.png"},548:function(s,t,a){s.exports=a.p+"assets/img/console.9f824a65.png"},627:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"webvirtcloud部署笔记"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webvirtcloud部署笔记"}},[s._v("#")]),s._v(" WebVirtCloud部署笔记")]),s._v(" "),n("h2",{attrs:{id:"系统配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#系统配置"}},[s._v("#")]),s._v(" 系统配置")]),s._v(" "),n("h3",{attrs:{id:"selinux"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#selinux"}},[s._v("#")]),s._v(" SELinux")]),s._v(" "),n("p",[s._v("允许"),n("code",[s._v("WebVirtCloud")]),s._v("通行")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" semanage fcontext -a -t httpd_sys_content_t "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/srv/webvirtcloud(/.*)"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("或关闭"),n("code",[s._v("SELINUX")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/selinux/config\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("SELINUX")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("disabled")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"防火墙"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#防火墙"}},[s._v("#")]),s._v(" 防火墙")]),s._v(" "),n("p",[s._v("允许"),n("code",[s._v("nginx")]),s._v("和"),n("code",[s._v("novnc")]),s._v("通行。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("firewall-cmd --zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp --permanent      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx")]),s._v("\nfirewall-cmd --zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6080")]),s._v("/tcp --permanent    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# novnc")]),s._v("\nfirewall-cmd --reload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"安装kvm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装kvm"}},[s._v("#")]),s._v(" 安装KVM")]),s._v(" "),n("h3",{attrs:{id:"虚拟化支持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟化支持"}},[s._v("#")]),s._v(" 虚拟化支持")]),s._v(" "),n("p",[s._v("执行以下命令，若有高亮"),n("code",[s._v("vmx")]),s._v("或"),n("code",[s._v("svm")]),s._v("输出表示硬件支持虚拟化。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("egrep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(vmx|svm)'")]),s._v(" --color"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always /proc/cpuinfo\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"设置网桥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置网桥"}},[s._v("#")]),s._v(" 设置网桥")]),s._v(" "),n("p",[s._v("网桥相当于外网和虚拟机之间的交换机。")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("             +-----------+     +----------+     +----------+\nInternet --- | HOST eth0 | --- | HOST br0 | --- | VMs eth0 | --- VMs\n             +-----------+     +----------+     +----------+\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/sysconfig/network-scripts/ifcfg-enp2s0 /etc/sysconfig/network-scripts/ifcfg-br0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("TYPE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("Bridge                                   # 类型为网桥")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("PROXY_METHOD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("none")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("BROWSER_ONLY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("BOOTPROTO")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("dhcp                                # MAC未绑定IP时建议配置静态IP")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("DEFROUTE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV4_FAILURE_FATAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6INIT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_AUTOCONF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_DEFROUTE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_FAILURE_FATAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_ADDR_GEN_MODE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("stable-privacy")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("NAME")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("br0                                      # 名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# UUID=87cd35a1-1421-4066-a7bc-9d8ba4e727d5   # 注释掉")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("DEVICE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("br0                                    # 设备")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("ONBOOT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("ZONE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("public")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysconfig/network-scripts/ifcfg-enp2s0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("BRIDGE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("br0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("TYPE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("Ethernet")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("PROXY_METHOD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("none")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("BROWSER_ONLY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("BOOTPROTO")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("dhcp")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("DEFROUTE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV4_FAILURE_FATAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6INIT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_AUTOCONF")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_DEFROUTE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_FAILURE_FATAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("IPV6_ADDR_GEN_MODE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("stable-privacy")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("NAME")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("enp2s0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("UUID")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("87cd35a1-1421-4066-a7bc-9d8ba4e727d5")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("DEVICE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("enp2s0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("ONBOOT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("ZONE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("public")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("systemctl restart network\nbrctl show\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"安装kvm依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装kvm依赖"}},[s._v("#")]),s._v(" 安装KVM依赖")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" kvm qemu-kvm qemu-kvm-tools libvirt libvirt-python libvirt-client\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" virt-install python-virtinst bridge-utils libguestfs-tools\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("table",[n("thead",[n("tr",[n("th",[s._v("名称")]),s._v(" "),n("th",[s._v("必须")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("kvm")]),s._v(" "),n("td",[s._v("是")]),s._v(" "),n("td",[s._v("KVM核心，KVM虚拟机模块")])]),s._v(" "),n("tr",[n("td",[s._v("qemu-kvm")]),s._v(" "),n("td",[s._v("是")]),s._v(" "),n("td",[s._v("QEMU模拟器，QEMU KVM虚拟化模拟器")])]),s._v(" "),n("tr",[n("td",[s._v("qemu-kvm-tools")]),s._v(" "),n("td",[s._v("是")]),s._v(" "),n("td",[s._v("QEMU工具，QEMU工具")])]),s._v(" "),n("tr",[n("td",[s._v("libvirt")]),s._v(" "),n("td",[s._v("是")]),s._v(" "),n("td",[s._v("虚拟化API，虚拟化平台的开源的API")])]),s._v(" "),n("tr",[n("td",[s._v("libvirt-python")]),s._v(" "),n("td",[s._v("是")]),s._v(" "),n("td",[s._v("libvirt Python语言支持")])]),s._v(" "),n("tr",[n("td",[s._v("libvirt-client")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("libvirt 客户端")])]),s._v(" "),n("tr",[n("td",[s._v("virt-install")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("虚拟机安装工具")])]),s._v(" "),n("tr",[n("td",[s._v("python-virtinst")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("虚拟机安装工具Python语言支持")])]),s._v(" "),n("tr",[n("td",[s._v("brige-utils")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("网桥管理工具")])]),s._v(" "),n("tr",[n("td",[s._v("libguestfs-tools")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("虚拟机镜像管理工具")])]),s._v(" "),n("tr",[n("td",[s._v("virt-manager")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("虚拟机管理工具，需要GUI")])]),s._v(" "),n("tr",[n("td",[s._v("virt-viewer")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("虚拟机查看工具，需要GUI")])]),s._v(" "),n("tr",[n("td",[s._v("virt-v2v")]),s._v(" "),n("td"),s._v(" "),n("td",[s._v("虚拟机镜像转换工具")])])])]),s._v(" "),n("h3",{attrs:{id:"设置服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置服务"}},[s._v("#")]),s._v(" 设置服务")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("systemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" libvirtd   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置服务自启动")]),s._v("\nsystemctl start libvirtd    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动服务")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"安装webvirtcloud"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装webvirtcloud"}},[s._v("#")]),s._v(" 安装WebVirtCloud")]),s._v(" "),n("p",[s._v("参见："),n("a",{attrs:{href:"https://github.com/retspen/webvirtcloud",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/retspen/webvirtcloud"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"更新-hypervisor-gstfsd"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#更新-hypervisor-gstfsd"}},[s._v("#")]),s._v(" 更新 hypervisor gstfsd")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O - https://clck.ru/9VMRH "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" -a /usr/local/bin/gstfsd\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" supervisor restart\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"获取secret-key"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取secret-key"}},[s._v("#")]),s._v(" 获取SECRET_KEY")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /srv/webvirtcloud/webvirtcloud/settings.py\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" random"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" string\nhaystack "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ascii_letters "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("digits "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("punctuation\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("random"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SystemRandom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("choice"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("haystack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" _ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"安装webvirtcloud控制台"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装webvirtcloud控制台"}},[s._v("#")]),s._v(" 安装WebVirtCloud控制台")]),s._v(" "),n("h4",{attrs:{id:"安装webvirtcloud依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装webvirtcloud依赖"}},[s._v("#")]),s._v(" 安装WebVirtCloud依赖")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python-virtualenv python-devel libvirt-devel\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" glibc gcc nginx supervisor python-lxml "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" python-libguestfs\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"克隆仓库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#克隆仓库"}},[s._v("#")]),s._v(" 克隆仓库")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /srv "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /srv\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/retspen/webvirtcloud "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" webvirtcloud\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" webvirtcloud/settings.py.template webvirtcloud/settings.py\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# now put secret key to webvirtcloud/settings.py")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h4",{attrs:{id:"开始安装webvirtcloud"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开始安装webvirtcloud"}},[s._v("#")]),s._v(" 开始安装WebVirtCloud")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" virtualenv venv\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" venv/bin/activate\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" venv/bin/pip "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -r conf/requirements.txt\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" conf/nginx/webvirtcloud.conf /etc/nginx/conf.d/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" venv/bin/python manage.py migrate\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"配置supervisor"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置supervisor"}},[s._v("#")]),s._v(" 配置supervisor")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/supervisord.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把以下内容添加到 [include] 段的 `files = ...` 之后")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("program:webvirtcloud")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/srv/webvirtcloud/venv/bin/gunicorn webvirtcloud.wsgi:application -c /srv/webvirtcloud/gunicorn.conf.py")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("directory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/srv/webvirtcloud")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("nginx")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("autostart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("autorestart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("redirect_stderr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("program:novncd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/srv/webvirtcloud/venv/bin/python /srv/webvirtcloud/console/novncd")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("directory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/srv/webvirtcloud")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("nginx")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("autostart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("autorestart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("redirect_stderr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h4",{attrs:{id:"配置nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置nginx"}},[s._v("#")]),s._v(" 配置nginx")]),s._v(" "),n("p",[s._v("注释"),n("code",[s._v("nginx")]),s._v("原有"),n("code",[s._v("server")]),s._v("段相关配置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/nginx/nginx.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    server {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        listen       80 default_server;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        listen       [::]:80 default_server;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        server_name  _;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        root         /usr/share/nginx/html;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        # Load configuration files for the default server block.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        include /etc/nginx/default.d/*.conf;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        location / {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        error_page 404 /404.html;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#            location = /40x.html {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        error_page 500 502 503 504 /50x.html;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#            location = /50x.html {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#        }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[s._v("确保webvirtcloud.conf配置正确")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/nginx/conf.d/webvirtcloud.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-nginx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" gunicorn_server")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#server unix:/srv/webvirtcloud/venv/wvcloud.socket fail_timeout=0;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 127.0.0.1:8000 fail_timeout=0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" servername.domain.com")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v(" /var/log/nginx/webvirtcloud-access_log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /static/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v(" /srv/webvirtcloud")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("expires")]),s._v(" max")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" http://gunicorn_server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_set_header")]),s._v(" X-Real-IP "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_set_header")]),s._v(" X-Forwarded-for "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$proxy_add_x_forwarded_for")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_set_header")]),s._v(" Host "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$host")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$server_port")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_set_header")]),s._v(" X-Forwarded-Proto "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_connect_timeout")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_read_timeout")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_send_timeout")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token directive"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("client_max_body_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024M")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h3",{attrs:{id:"用户和组设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户和组设置"}},[s._v("#")]),s._v(" 用户和组设置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" webvirtmgr\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -G kvm -a webvirtmgr\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"启动服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[s._v("#")]),s._v(" 启动服务")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("systemctl restart nginx\nsystemctl restart supervisord\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("supervisorctl status\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("gstfsd             RUNNING   pid 24662, uptime 6:01:40\nnovncd             RUNNING   pid 24661, uptime 6:01:40\nwebvirtcloud       RUNNING   pid 24660, uptime 6:01:40\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"添加ssh-key"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加ssh-key"}},[s._v("#")]),s._v(" 添加SSH KEY")]),s._v(" "),n("p",[s._v("用于控制台添加基础架构")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -s /bin/bash nginx\nssh-keygen\nssh-copy-id root@serverip\nyou need to accept "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" key\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"控制台"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#控制台"}},[s._v("#")]),s._v(" 控制台")]),s._v(" "),n("h3",{attrs:{id:"进入控制台"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#进入控制台"}},[s._v("#")]),s._v(" 进入控制台")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" http://serverip\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# username: admin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# password: admin")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"基础架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础架构"}},[s._v("#")]),s._v(" 基础架构")]),s._v(" "),n("p",[n("img",{attrs:{src:a(544),alt:"compute"}})]),s._v(" "),n("h3",{attrs:{id:"存储池"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#存储池"}},[s._v("#")]),s._v(" 存储池")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" -R /home/webvirtmgr\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/home/webvirtmgr\n|-- images          # 磁盘镜像\n`-- iso             # 光盘镜像\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("img",{attrs:{src:a(545),alt:"storage"}})]),s._v(" "),n("h3",{attrs:{id:"网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络"}},[s._v("#")]),s._v(" 网络")]),s._v(" "),n("p",[n("img",{attrs:{src:a(546),alt:"network"}})]),s._v(" "),n("h3",{attrs:{id:"实例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),n("p",[n("img",{attrs:{src:a(547),alt:"instance"}})]),s._v(" "),n("h3",{attrs:{id:"会话"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#会话"}},[s._v("#")]),s._v(" 会话")]),s._v(" "),n("p",[n("img",{attrs:{src:a(548),alt:"console"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);