(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{588:function(s,a,n){"use strict";n.r(a);var e=n(1),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"centos安装配置openvpn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#centos安装配置openvpn"}},[s._v("#")]),s._v(" CentOS安装配置OpenVPN")]),s._v(" "),n("blockquote",[n("p",[s._v("环境")])]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("环境")]),s._v(" "),n("th",[s._v("版本")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("CentOS")]),s._v(" "),n("td",[s._v("el8")]),s._v(" "),n("td",[s._v("兼容el7")])]),s._v(" "),n("tr",[n("td",[s._v("easy-rsa")]),s._v(" "),n("td",[s._v("3.0.6-1.el7")]),s._v(" "),n("td")]),s._v(" "),n("tr",[n("td",[s._v("openvpn")]),s._v(" "),n("td",[s._v("2.4.8-1.el7")]),s._v(" "),n("td")])])]),s._v(" "),n("blockquote",[n("p",[s._v("流程")])]),s._v(" "),n("Mermaid",{attrs:{id:"mermaid-382ee1e3","data-code":"graph%20TB%0AA(%E5%AE%89%E8%A3%85OpenVPN%E5%92%8C%E8%AF%81%E4%B9%A6%E7%94%9F%E6%88%90%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96)%0AA%20--%3E%20B(%E7%94%9F%E6%88%90CA%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%AF%81%E4%B9%A6)%0AB%20--%3E%20C(%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEserver.conf)%0AC%20--%3E%20D(%E6%B7%BB%E5%8A%A0%E9%98%B2%E7%81%AB%E5%A2%99%E8%A7%84%E5%88%99)%0AD%20--%3E%20E(%E5%90%AF%E5%8A%A8OpenVPN%E6%9C%8D%E5%8A%A1)%0AE%20--%3E%20F(%E7%94%9F%E6%88%90%E5%AE%A2%E6%88%B7%E7%AB%AFCA%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AF%81%E4%B9%A6)%0AF%20--%3E%20G(%E6%89%93%E5%8C%85%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6%E6%88%90.ovpn%E4%BE%9B%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8)%0AG%20--%3E%20H(%E5%AE%89%E8%A3%85OpenVPN%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5VPN)%0A"}}),n("h2",{attrs:{id:"安装依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[s._v("#")]),s._v(" 安装依赖")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("dnf "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强烈建议使用国内repo源，如：阿里云")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo\ndnf "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openvpn easy-rsa\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"目录结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[s._v("#")]),s._v(" 目录结构")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("|-- easy-rsa                # 证书制作工具\n|   |-- pki                 #   PKI\n|   `-- vars                #   easy-rsa配置\n|-- certs                   # 证书存放目录\n|   |-- server              #   服务端\n|   |   |-- ca.crt          #     CA根证书\n|   |   |-- ta.key          #     TLS鉴权密钥\n|   |   |-- dh.pem          #     SSL协商DH\n|   |   |-- server.crt      #     服务器证书\n|   |   `-- server.key      #     服务器私钥\n|   `-- client              # 证书客户端\n|       `-- user01          #   用户01\n|           |-- ca.crt      #     CA根证书\n|           |-- ta.key      #     TLS鉴权密钥\n|           |-- user01.crt  #     用户证书\n|           |-- user01.key  #     用户私钥\n|           `-- user01.ovpn #     OpenVPN客户端集成配置\n|-- client                  # 密码用户配置（固定IP）\n|   |-- user1               #   用户1\n|   `-- user2               #   用户2\n`-- sever.conf              # 服务端配置：openvpn@server\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h2",{attrs:{id:"配置easy-rsa"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置easy-rsa"}},[s._v("#")]),s._v(" 配置easy-rsa")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /usr/share/easy-rsa/3.0.6/ /etc/openvpn/easy-rsa/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/share/doc/easy-rsa-3.0.3/vars.example /etc/openvpn/easy-rsa/vars\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/openvpn/vars\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请根据需要修改，否则使用默认值")]),s._v('\nset_var EASYRSA_REQ_COUNTRY    "US"\nset_var EASYRSA_REQ_PROVINCE   "California"\nset_var EASYRSA_REQ_CITY       "San Francisco"\nset_var EASYRSA_REQ_ORG        "Copyleft Certificate Co"\nset_var EASYRSA_REQ_EMAIL      "me@example.net"\nset_var EASYRSA_REQ_OU         "My Organizational Unit"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"服务端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务端"}},[s._v("#")]),s._v(" 服务端")]),s._v(" "),n("h3",{attrs:{id:"创建pki、ca、证书、密钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建pki、ca、证书、密钥"}},[s._v("#")]),s._v(" 创建PKI、CA、证书、密钥")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/openvpn/easy-rsa\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建PKI")]),s._v("\n./easyrsa init-pki\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Note: using Easy-RSA configuration from: ./vars")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Your newly created PKI dir is: /etc/openvpn/easy-rsa/pki")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建新的CA，不使用密码")]),s._v("\n./easyrsa build-ca nopass\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Common Name (eg: your user, host, or server name) [Easy-RSA CA]: # 直接回车")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Your new CA certificate file for publishing is at: /etc/openvpn/easy-rsa/pki/ca.crt")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建服务端证书和密钥")]),s._v("\n./easyrsa gen-req server nopass\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Common Name (eg: your user, host, or server name) [server]: # 直接回车，默认server")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Keypair and certificate request completed. Your files are:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# req: /etc/openvpn/easy-rsa/pki/reqs/server.req")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# key: /etc/openvpn/easy-rsa/pki/private/server.key")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 签约服务端证书")]),s._v("\n./easyrsa sign server server\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request subject, to be signed as a server certificate for 1080 days:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# subject=")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    commonName                = server")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Type the word 'yes' to continue, or any other input to abort.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  Confirm request details: yes # 输入yes回车")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建Diffie-Hellman")]),s._v("\n./easyrsa gen-dh\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# DH parameters of size 2048 created at /etc/openvpn/easy-rsa/pki/dh.pem")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建tls-auth key")]),s._v("\nopenvpn --genkey --secret ta.key\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h3",{attrs:{id:"整理密钥和证书"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#整理密钥和证书"}},[s._v("#")]),s._v(" 整理密钥和证书")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/openvpn/certs/server\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/dh.pem "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/ta.key "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/ca.crt "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/issued/server.crt "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/private/server.key "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"配置服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置服务器"}},[s._v("#")]),s._v(" 配置服务器")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/openvpn/server.conf")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其样本位于/usr/share/doc/openvpn-2.4.8/sample/sample-config-files/server.conf")]),s._v("\nport 1194 # 监听的端口号\nproto udp # 服务端用的协议，一般用稍快的udp\ndev tun\nca /etc/openvpn/server/certs/ca.crt # CA 根证书路径\ncert /etc/openvpn/server/certs/server.crt # open VPN 服务器证书路径\nkey /etc/openvpn/server/certs/server.key # open VPN 服务器密钥路径，请勿泄露！\ndh /etc/openvpn/server/certs/dh.pem # Diffie-Hellman 算法密钥文件路径\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tls-auth key，参数 0 可以省略，如果不省略，那么客户端配置相应的参数该配成 1。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果省略，那么客户端不需要 tls-auth 配置")]),s._v("\ntls-auth /etc/openvpn/server/certs/ta.key 0\nserver 10.8.0.0 255.255.255.0 # OpenVPN子网，默认为 10.8.0.0/24\ncompress lzo\nduplicate-cn   # 允许一个用户多个终端连接\nkeepalive 10 120\ncomp-lzo\npersist-key\npersist-tun\nverb 3\nexplicit-exit-notify 1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h3",{attrs:{id:"启动服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[s._v("#")]),s._v(" 启动服务")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("systemctl start openvpn@server    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动")]),s._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" openvepn@server  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置自启动")]),s._v("\nfirewall-cmd --zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1194")]),s._v("/udp --permanent  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# success")]),s._v("\nfirewall-cmd --reload             "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开发防火墙端口并重载防火墙")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"证书客户端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#证书客户端"}},[s._v("#")]),s._v(" 证书客户端")]),s._v(" "),n("p",[s._v("多个客户端请自行重复以下操作")]),s._v(" "),n("h3",{attrs:{id:"创建证书和密钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建证书和密钥"}},[s._v("#")]),s._v(" 创建证书和密钥")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/openvpn/easy-rsa\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 创建服务端证书和密钥")]),s._v("\n./easyrsa gen-req user01 nopass\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Common Name (eg: your user, host, or server name) [user01]: # 直接回车")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Keypair and certificate request completed. Your files are:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# req: /etc/openvpn/client/easy-rsa/pki/reqs/user01.req")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# key: /etc/openvpn/client/easy-rsa/pki/private/user01.key")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 签约客户端证书")]),s._v("\n./easyrsa sign client user01\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Request subject, to be signed as a client certificate for 1080 days:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# subject=")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#     commonName                = user01")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Type the word 'yes' to continue, or any other input to abort.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  Confirm request details: yes # 输入yes回车")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h3",{attrs:{id:"整理证书和密钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#整理证书和密钥"}},[s._v("#")]),s._v(" 整理证书和密钥")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/openvpn/certs/client/user01\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/ta.key "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/ca.crt "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/issued/user01.crt "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/openvpn/easy-rsa/pki/private/user01.key "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"证书客户端配置ovpn文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#证书客户端配置ovpn文件"}},[s._v("#")]),s._v(" 证书客户端配置ovpn文件")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("client\ndev tun\nproto udp\nremote your.openvpn.server 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nremote-cert-tls server\ncipher AES-256-CBC\ncomp-lzo\nnice 0\nverb 3\nmute 10\nkey-direction 1\n<tls-auth>\nta.key 文件内容\n</tls-auth>\n<ca>\nca.crt 文件内容\n</ca>\n<cert>\nclient.crt 文件内容\n</cert>\n<key>\nclient.key 文件内容\n</key>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h2",{attrs:{id:"密码客户端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#密码客户端"}},[s._v("#")]),s._v(" 密码客户端")]),s._v(" "),n("h3",{attrs:{id:"用户认证脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户认证脚本"}},[s._v("#")]),s._v(" 用户认证脚本")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###########################################################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# checkpsw.sh (C) 2004 Mathias Sundman <mathias@openvpn.se>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This script will authenticate OpenVPN users against")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# a plain text file. The passfile should simply contain")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# one row per user with the username first followed by")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# one or more space(s) or tab(s) and then the password.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###########################################################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PASSFILE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/openvpn/psw-file"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LOG_FILE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/openvpn/openvpn-password.log"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TIME_STAMP")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%d %T"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -r "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PASSFILE}")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TIME_STAMP}")]),s._v(": Could not open password file "),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PASSFILE}")]),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(' for reading."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LOG_FILE}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CORRECT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'!/^;/&&!/^#/&&$1==\"'")]),s._v("$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"{print $2;exit}'")]),s._v(" $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("PASSFILE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CORRECT_PASSWORD}")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TIME_STAMP}")]),s._v(": User does not exist: username="),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(", password="),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${password}")]),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LOG_FILE}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${password}")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CORRECT_PASSWORD}")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TIME_STAMP}")]),s._v(": Successful authentication: username="),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LOG_FILE}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TIME_STAMP}")]),s._v(": Incorrect password: username="),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(", password="),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${password}")]),n("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v('."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LOG_FILE}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 赋予可执行权限")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/openvpn/checkpsw.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"用户密码文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户密码文件"}},[s._v("#")]),s._v(" 用户密码文件")]),s._v(" "),n("p",[s._v("位于"),n("code",[s._v("/etc/openvpn/psw-file")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("user1 passwd1\nuser2 passwd2\n# chown nobody.nobody /etc/openvpn/psw-file\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"用户固定ip配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户固定ip配置"}},[s._v("#")]),s._v(" 用户固定IP配置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/openvpn/client/user1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R nobody.nobody /etc/openvpn/client")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ifconfig-push  10.8.0.9  10.8.0.10\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("blockquote",[n("p",[n("code",[s._v("ifconfig-push")]),s._v("中的每一对IP地址表示虚拟客户端和服务器的IP端点。它们必须从连续的/30子网网段中获取(这里是/30表示xxx.xxx.xxx.xxx/30，即子网掩码位数为30)，以便于与Windows客户端和TAP-Windows驱动兼容。明确地说，每个端点的IP地址对的最后8位字节必须取自下面的集合：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[1, 2]    [5, 6]    [9, 10]   [ 13, 14] [ 17, 18]\n[21, 22]  [25, 26]  [ 29, 30] [ 33, 34] [ 37, 38]\n[41, 42]  [45, 46]  [ 49, 50] [ 53, 54] [ 57, 58]\n[ 61, 62] [65, 66]  [ 69, 70] [ 73, 74] [ 77, 78]\n[ 81, 82] [ 85, 86] [ 89, 90] [ 93, 94] [ 97, 98]\n[101,102] [105,106] [109,110] [113,114] [117,118]\n[121,122] [125,126] [129,130] [133,134] [137,138]\n[141,142] [145,146] [149,150] [153,154] [157,158]\n[161,162] [165,166] [169,170] [173,174] [177,178]\n[181,182] [185,186] [189,190] [193,194] [197,198]\n[201,202] [205,206] [209,210] [213,214] [217,218]\n[221,222] [225,226] [229,230] [233,234] [237,238]\n[241,242] [245,246] [249,250] [253,254]\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"修改服务器配置支持用户密码登录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改服务器配置支持用户密码登录"}},[s._v("#")]),s._v(" 修改服务器配置支持用户密码登录")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("script-security 3\nauth-user-pass-verify /etc/openvpn/checkpsw.sh via-env # 指定用户认证脚本\nusername-as-common-name\nverify-client-cert none\nclient-cert-not-required              # 非双重验证，仅用户名密码验证\nclient-config-dir /etc/openvpn/client # 客户端配置（固定IP）\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"密码客户端配置文件ovpn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#密码客户端配置文件ovpn"}},[s._v("#")]),s._v(" 密码客户端配置文件ovpn")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("client\ndev tun\nproto udp\nremote your.openvpn.server 1194\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\nremote-cert-tls server\nauth-nocache\nauth-user-pass\ncipher AES-256-CBC\ncomp-lzo\nnice 0\nverb 3\nmute 10\nkey-direction 1\n<tls-auth>\nta.key 文件内容\n</tls-auth>\n<ca>\nca.crt 文件内容\n</ca>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h2",{attrs:{id:"openvpn客户端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#openvpn客户端"}},[s._v("#")]),s._v(" OpenVPN客户端")]),s._v(" "),n("p",[s._v("OpenVPN UI "),n("a",{attrs:{href:"https://openvpn.net/community-downloads",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方下载地址"),n("OutboundLink")],1),s._v("，鉴于需科学上网，请自行解决下载。")]),s._v(" "),n("p",[s._v("安装并运行，导入制作好的ovpn文件，连接，若启用密码验证，输入用户名密码，确定，即可连接VPN。")]),s._v(" "),n("h2",{attrs:{id:"提醒"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#提醒"}},[s._v("#")]),s._v(" 提醒")]),s._v(" "),n("ul",[n("li",[s._v("启用密码验证则不能仅依赖证书通过验证，但密码验证可启用证书进行双重验证")]),s._v(" "),n("li",[s._v("大型商业用户可以使用付费便于管理的"),n("code",[s._v("OpenVPN Access Server")]),s._v("，使用"),n("code",[s._v("OpenVPN Connect")]),s._v("客户端连接VPN。")])]),s._v(" "),n("blockquote",[n("p",[s._v("方跃明\n2020-01-29")])])],1)}),[],!1,null,null,null);a.default=t.exports}}]);