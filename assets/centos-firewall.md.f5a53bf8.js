import{_ as s,o as a,c as l,Q as n}from"./chunks/framework.d5af2850.js";const C=JSON.parse('{"title":"CentOS 防火墙","description":"CentOS 使用 firewalld 防火墙系统，大多数服务需要防火墙放行才能被访问。","frontmatter":{"title":"CentOS 防火墙","description":"CentOS 使用 firewalld 防火墙系统，大多数服务需要防火墙放行才能被访问。","time":"2019-12-26T00:00:00.000Z","category":"运维","tags":["CentOS","Linux"]},"headers":[],"relativePath":"centos-firewall.md","filePath":"centos-firewall.md"}'),p={name:"centos-firewall.md"},o=n(`<h1 id="centos防火墙" tabindex="-1">CentOS防火墙 <a class="header-anchor" href="#centos防火墙" aria-label="Permalink to &quot;CentOS防火墙&quot;">​</a></h1><blockquote><p>方跃明 2019-12-26</p></blockquote><p>CentOS 使用 firewalld 防火墙系统，大多数服务需要防火墙放行才能被访问。</p><h2 id="放行" tabindex="-1">放行 <a class="header-anchor" href="#放行" aria-label="Permalink to &quot;放行&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 开启普通端口</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=public</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--add-port=80/tcp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--permanent</span></span>
<span class="line"><span style="color:#6A737D;"># 开启NAT转发，比如Docker Proxy</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=public</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--add-masquerade</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--permanent</span></span>
<span class="line"><span style="color:#6A737D;"># 重载防火墙使配置立即生效</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--reload</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 开启普通端口</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=public</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--add-port=80/tcp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--permanent</span></span>
<span class="line"><span style="color:#6A737D;"># 开启NAT转发，比如Docker Proxy</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=public</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--add-masquerade</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--permanent</span></span>
<span class="line"><span style="color:#6A737D;"># 重载防火墙使配置立即生效</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--reload</span></span></code></pre></div><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>--zone</td><td>作用域，public = 公共区域</td></tr><tr><td>--add-port=80/tcp</td><td>添加端口，格式为：端口/通讯协议</td></tr><tr><td>--permanent</td><td>永久生效，没有此参数重启后失效</td></tr></tbody></table><h2 id="服务" tabindex="-1">服务 <a class="header-anchor" href="#服务" aria-label="Permalink to &quot;服务&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">start</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">firewalld</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 启动</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stop</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">firewalld</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 停止</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">firewalld</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 重启</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">status</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">firewalld</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 状态</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">disable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">firewalld</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 禁用</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enable</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">firewalld</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 自启动</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">start</span><span style="color:#24292E;">   </span><span style="color:#032F62;">firewalld</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 启动</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stop</span><span style="color:#24292E;">    </span><span style="color:#032F62;">firewalld</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 停止</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span><span style="color:#24292E;"> </span><span style="color:#032F62;">firewalld</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 重启</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">status</span><span style="color:#24292E;">  </span><span style="color:#032F62;">firewalld</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 状态</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">disable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">firewalld</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 禁用</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enable</span><span style="color:#24292E;">  </span><span style="color:#032F62;">firewalld</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 自启动</span></span></code></pre></div><h2 id="命令" tabindex="-1">命令 <a class="header-anchor" href="#命令" aria-label="Permalink to &quot;命令&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--version</span><span style="color:#E1E4E8;">                            </span><span style="color:#6A737D;"># 查看版本</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--help</span><span style="color:#E1E4E8;">                               </span><span style="color:#6A737D;"># 查看帮助</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--state</span><span style="color:#E1E4E8;">                              </span><span style="color:#6A737D;"># 状态</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--reload</span><span style="color:#E1E4E8;">                             </span><span style="color:#6A737D;"># 更新防火墙规则</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--complete-reload</span><span style="color:#E1E4E8;">                    </span><span style="color:#6A737D;"># 更新防火墙规则（断开连接）</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--list-all</span><span style="color:#E1E4E8;">                           </span><span style="color:#6A737D;"># 列出所有规则</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--list-port</span><span style="color:#E1E4E8;">                          </span><span style="color:#6A737D;"># 列出所有放行端口</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--panic-on</span><span style="color:#E1E4E8;">                           </span><span style="color:#6A737D;"># 拒绝所有包</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--panic-off</span><span style="color:#E1E4E8;">                          </span><span style="color:#6A737D;"># 取消拒绝状态</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--query-panic</span><span style="color:#E1E4E8;">                        </span><span style="color:#6A737D;"># 查看是否拒绝</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--get-active-zones</span><span style="color:#E1E4E8;">                   </span><span style="color:#6A737D;"># 查看区域信息</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--set-default-zone=public</span><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;"># 设置默认区域</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--get-zone-of-interface=eth0</span><span style="color:#E1E4E8;">         </span><span style="color:#6A737D;"># 查看指定接口所属区域</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=dmz</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--list-ports</span><span style="color:#E1E4E8;">              </span><span style="color:#6A737D;"># 查看所有打开的端口</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=public</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--add-interface=eth0</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># 指定区域加入接口</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=dmz</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--add-port=8080/tcp</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;"># 加入一个端口到区域</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=work</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--add-service=smtp</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;"># 添加一个服务</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--zone=work</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--remove-service=smtp</span><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># 移除一个服务</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--version</span><span style="color:#24292E;">                            </span><span style="color:#6A737D;"># 查看版本</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--help</span><span style="color:#24292E;">                               </span><span style="color:#6A737D;"># 查看帮助</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--state</span><span style="color:#24292E;">                              </span><span style="color:#6A737D;"># 状态</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--reload</span><span style="color:#24292E;">                             </span><span style="color:#6A737D;"># 更新防火墙规则</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--complete-reload</span><span style="color:#24292E;">                    </span><span style="color:#6A737D;"># 更新防火墙规则（断开连接）</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--list-all</span><span style="color:#24292E;">                           </span><span style="color:#6A737D;"># 列出所有规则</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--list-port</span><span style="color:#24292E;">                          </span><span style="color:#6A737D;"># 列出所有放行端口</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--panic-on</span><span style="color:#24292E;">                           </span><span style="color:#6A737D;"># 拒绝所有包</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--panic-off</span><span style="color:#24292E;">                          </span><span style="color:#6A737D;"># 取消拒绝状态</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--query-panic</span><span style="color:#24292E;">                        </span><span style="color:#6A737D;"># 查看是否拒绝</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--get-active-zones</span><span style="color:#24292E;">                   </span><span style="color:#6A737D;"># 查看区域信息</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--set-default-zone=public</span><span style="color:#24292E;">            </span><span style="color:#6A737D;"># 设置默认区域</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--get-zone-of-interface=eth0</span><span style="color:#24292E;">         </span><span style="color:#6A737D;"># 查看指定接口所属区域</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=dmz</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--list-ports</span><span style="color:#24292E;">              </span><span style="color:#6A737D;"># 查看所有打开的端口</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=public</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--add-interface=eth0</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># 指定区域加入接口</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=dmz</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--add-port=8080/tcp</span><span style="color:#24292E;">       </span><span style="color:#6A737D;"># 加入一个端口到区域</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=work</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--add-service=smtp</span><span style="color:#24292E;">       </span><span style="color:#6A737D;"># 添加一个服务</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--zone=work</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--remove-service=smtp</span><span style="color:#24292E;">    </span><span style="color:#6A737D;"># 移除一个服务</span></span></code></pre></div>`,10),e=[o];function t(c,r,y,E,i,d){return a(),l("div",null,e)}const m=s(p,[["render",t]]);export{C as __pageData,m as default};
