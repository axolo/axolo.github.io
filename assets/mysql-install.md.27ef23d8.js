import{_ as s,o as a,c as l,R as n}from"./chunks/framework.6ea6e512.js";const d=JSON.parse('{"title":"CentOS 安装 MySQL 8","description":"CentOS 下快速安装配置 MySQL 8","frontmatter":{"title":"CentOS 安装 MySQL 8","description":"CentOS 下快速安装配置 MySQL 8","time":"2019-05-11T00:00:00.000Z","category":"数据库","tags":["CentOS","MySQL","Linux"]},"headers":[],"relativePath":"mysql-install.md","filePath":"mysql-install.md"}'),o={name:"mysql-install.md"},p=n(`<h1 id="centos-安装-mysql-8" tabindex="-1">CentOS 安装 MySQL 8 <a class="header-anchor" href="#centos-安装-mysql-8" aria-label="Permalink to &quot;CentOS 安装 MySQL 8&quot;">​</a></h1><blockquote><p>方跃明 2019-05-11</p></blockquote><h2 id="一、安装并登录" tabindex="-1">一、安装并登录 <a class="header-anchor" href="#一、安装并登录" aria-label="Permalink to &quot;一、安装并登录&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 安装官方仓库</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">localinstall</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://repo.mysql.com/mysql80-community-release-el7-1.noarch.rpm</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 安装 MySQL Server</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql-community-server</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 启动MySQL</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysqld</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 检查服务状态</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">status</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysqld</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 查看初始密码</span></span>
<span class="line"><span style="color:#FFCB6B;">grep</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">temporary password</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/log/mysqld.log</span></span>
<span class="line"><span style="color:#FFCB6B;">mysql</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-uroot</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 输入密码进入mysql命令行</span></span></code></pre></div><h2 id="二、修改密码策略-可选" tabindex="-1">二、修改密码策略（可选） <a class="header-anchor" href="#二、修改密码策略-可选" aria-label="Permalink to &quot;二、修改密码策略（可选）&quot;">​</a></h2><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;"> validate_password.policy</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;"> validate_password.length</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><h2 id="三、修改密码" tabindex="-1">三、修改密码 <a class="header-anchor" href="#三、修改密码" aria-label="Permalink to &quot;三、修改密码&quot;">​</a></h2><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">USER</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> IDENTIFIED </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">password</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><h2 id="四、添加用户并授权" tabindex="-1">四、添加用户并授权 <a class="header-anchor" href="#四、添加用户并授权" aria-label="Permalink to &quot;四、添加用户并授权&quot;">​</a></h2><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">USER</span><span style="color:#A6ACCD;"> &#39;</span><span style="color:#82AAFF;">newuser</span><span style="color:#A6ACCD;">&#39;@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> IDENTIFIED </span><span style="color:#F78C6C;">WITH</span><span style="color:#A6ACCD;"> mysql_native_password </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">password</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- mysql_native_password 为传统加密方式，适配各种连接器</span></span>
<span class="line"><span style="color:#F78C6C;">GRANT</span><span style="color:#A6ACCD;"> ALL </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> newuser_db.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TO</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">newuser</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">FLUSH PRIVILEGES;</span></span></code></pre></div><h2 id="五、其他配置" tabindex="-1">五、其他配置 <a class="header-anchor" href="#五、其他配置" aria-label="Permalink to &quot;五、其他配置&quot;">​</a></h2><ol><li>设置SELinux为disabled，并生效</li><li>开启防火墙mysqld对应端口</li></ol><h2 id="六、忘记密码" tabindex="-1">六、忘记密码 <a class="header-anchor" href="#六、忘记密码" aria-label="Permalink to &quot;六、忘记密码&quot;">​</a></h2><h3 id="_1-设置skip-grant-tables" tabindex="-1">1. 设置skip-grant-tables <a class="header-anchor" href="#_1-设置skip-grant-tables" aria-label="Permalink to &quot;1. 设置skip-grant-tables&quot;">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/my.cnf</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 在 [mysqld] 段添加 skip-grant-tables，并重启mysql</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysqld</span></span></code></pre></div><h3 id="_2-清空密码" tabindex="-1">2. 清空密码 <a class="header-anchor" href="#_2-清空密码" aria-label="Permalink to &quot;2. 清空密码&quot;">​</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">USE</span><span style="color:#A6ACCD;"> mysql;</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> user </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> authentication_string</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><h3 id="_3-空密码登录" tabindex="-1">3. 空密码登录 <a class="header-anchor" href="#_3-空密码登录" aria-label="Permalink to &quot;3. 空密码登录&quot;">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/my.cnf</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 修改配置，注释刚刚添加的部分 # skip-grant-tables</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 重启MySQL</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysqld</span></span>
<span class="line"><span style="color:#FFCB6B;">mysql</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-uroot</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 空密码进入 mysql 命令行后使用 ALTER USER 修改密码</span></span></code></pre></div><h2 id="七、日常备份" tabindex="-1">七、日常备份 <a class="header-anchor" href="#七、日常备份" aria-label="Permalink to &quot;七、日常备份&quot;">​</a></h2><h3 id="_1-编写shell脚本-mysql-backup-sh" tabindex="-1">1. 编写Shell脚本：mysql-backup.sh <a class="header-anchor" href="#_1-编写shell脚本-mysql-backup-sh" aria-label="Permalink to &quot;1. 编写Shell脚本：mysql-backup.sh&quot;">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#A6ACCD;">day</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">\`</span><span style="color:#FFCB6B;">date</span><span style="color:#C3E88D;"> +%Y%m%d</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">$HOME</span><span style="color:#C3E88D;">/mysql-backup</span></span>
<span class="line"><span style="color:#FFCB6B;">find</span><span style="color:#A6ACCD;"> $dir </span><span style="color:#C3E88D;">-ctime</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+7</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-type</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">f</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">xargs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span></span>
<span class="line"><span style="color:#FFCB6B;">mysqldump</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-B</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sys</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-uroot</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-ppassword</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">gzip</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> $dir</span><span style="color:#C3E88D;">/sys-</span><span style="color:#A6ACCD;">$day</span><span style="color:#C3E88D;">.sql.gz</span></span></code></pre></div><h3 id="_2-赋予执行权限" tabindex="-1">2. 赋予执行权限 <a class="header-anchor" href="#_2-赋予执行权限" aria-label="Permalink to &quot;2. 赋予执行权限&quot;">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql-backup.sh</span></span></code></pre></div><h3 id="_3-添加到-etc-crontab-每天3点钟执行备份" tabindex="-1">3. 添加到<code>/etc/crontab</code>，每天3点钟执行备份 <a class="header-anchor" href="#_3-添加到-etc-crontab-每天3点钟执行备份" aria-label="Permalink to &quot;3. 添加到\`/etc/crontab\`，每天3点钟执行备份&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">0 3 * * * bash /path/to/mysql-backup.sh</span></span></code></pre></div><h4 id="_4-重启crond生效" tabindex="-1">4. 重启crond生效 <a class="header-anchor" href="#_4-重启crond生效" aria-label="Permalink to &quot;4. 重启crond生效&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/etc/rc.d/init.d/crond</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span></span></code></pre></div>`,28),e=[p];function t(c,r,y,C,i,D){return a(),l("div",null,e)}const h=s(o,[["render",t]]);export{d as __pageData,h as default};
